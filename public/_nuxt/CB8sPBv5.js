import{u as f}from"./BhWtroNR.js";import{u as k}from"./BUX9gV8r.js";const p=async(t,o,r,n,c=!1)=>{const a=await k(),{getAccessToken:e,storeAccessToken:g,storeRefreshToken:h}=f();let u="";try{u=await e()}catch{}try{return await $fetch(`${a.issuerUri}connect/auth/${n}`,{method:"post",body:JSON.stringify({oauth:{redirect_uri:r,...t},access_token:u,external:{code:o,redirect_uri:r},new:c}),parseResponse:i=>{const s=JSON.parse(i);return s.AccessToken&&g(s.AccessToken),s.RefreshToken&&h(s.RefreshToken),{CreateToken:s.CreateToken||"",RedirectURI:s.RedirectURI||"",ErrorMessage:s.ErrorMessage||"",Existing:s.Existing||!1}}})}catch(i){return{CreateToken:"",RedirectURI:"",ErrorMessage:i.toString(),Existing:!1}}},d=async(t,o)=>{const r=await k(),{storeAccessToken:n,storeRefreshToken:c}=f();try{return await $fetch(`${r.issuerUri}connect/auth/create`,{method:"post",body:JSON.stringify({oauth:t,create_token:o,new:!0}),parseResponse:a=>{const e=JSON.parse(a);return e.AccessToken&&n(e.AccessToken),e.RefreshToken&&c(e.RefreshToken),{ErrorMessage:e.ErrorMessage||"",RedirectURI:e.RedirectURI||""}}})}catch{return""}};export{d as a,p as u};
