import{u as b,s as u}from"./B-pYYkJ6.js";import{e as q,i as A,l as B,r as p,g as x,w as i,o as m,j as v,b as _,h as e,ab as V,c as h,t as d,a as E,n as R}from"./CQQOHgVg.js";import{u as P,a as $}from"./CB8sPBv5.js";import{_ as S}from"./DLuPry4q.js";import{V as N}from"./R19YWhS6.js";import{V as I,a as T}from"./hs6exKNd.js";import{y as j}from"./Be4K88FQ.js";import"./DdjJ-Vhj.js";import"./BhWtroNR.js";import"./B5CZD0j7.js";import"./BUX9gV8r.js";import"./_7wUQANC.js";import"./BGC9nr2s.js";import"./D1dM1BjZ.js";const z={key:0,class:"my-2"},D={key:1,class:"my-2"},M={key:2,class:"my-2"},F={class:"my-2"},G={class:"my-2"},ne=q({__name:"[method]",setup(H){const C=A(),a=B(),t=p(0),o=p(!1),n=p(!1),{getState:k}=b();console.log("a"),console.log(a.query.state);const c=k(a.query.state.toString(),!0),w=p("");console.log("b");const y=()=>{R(c.RedirectUri,{external:!0})},L=async()=>{const l=await $(c,w.value);if(l){const s=new URL(l).searchParams.get("error");s?s=="access_denied"&&(o.value=!0,t.value=3):R(l,{external:!0})}else o.value=!0,t.value=2},U=async()=>{if(!a.query.code){o.value=!0,t.value=2;return}console.log(1);const l=a.query.code.toString(),r=`${window.location.origin}${C.resolve(`/account/${a.params.method.toString()}`).href}`;console.log(r),console.log(2);const{CreateToken:s,RedirectURI:g}=await P(c,l,r,a.params.method.toString(),!1);if(console.log(3),s&&(w.value=s,console.log(4)),console.log(5),g){console.log(6),console.log(g);const f=new URL(g).searchParams.get("error");f?f=="access_denied"?(console.log(8),n.value=!0):f=="invalid_request"?(console.log(9),o.value=!0,t.value=1):f=="server_error"&&(console.log(10),o.value=!0,t.value=2):(console.log(7),console.log(g),console.log("SUCCESS"),await C.push("/account"))}else console.log(11),o.value=!0,t.value=2};return console.log("c"),c?(console.log("d"),U()):(console.log("e"),console.log(c),o.value=!0,t.value=2),(l,r)=>(m(),x(N,{class:"h-100"},{default:i(()=>[!e(n)&&!e(o)?(m(),x(I,{key:0,class:"h-100"},{default:i(()=>[_(T,{class:"text-center align-content-center"},{default:i(()=>[_(j,{color:"primary",size:110,width:12,indeterminate:""})]),_:1})]),_:1})):v("",!0),_(S,{modelValue:e(o),"onUpdate:modelValue":r[0]||(r[0]=s=>V(o)?o.value=s:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:y},{default:i(()=>[e(t)===1?(m(),h("p",z,d(e(u).messageCreateExternalError1),1)):v("",!0),e(t)===2?(m(),h("p",D,d(e(u).messageCreateExternalError2),1)):v("",!0),e(t)===3?(m(),h("p",M,d(e(u).messageCreateExternalError3),1)):v("",!0)]),_:1},8,["modelValue"]),_(S,{modelValue:e(n),"onUpdate:modelValue":r[1]||(r[1]=s=>V(n)?n.value=s:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",persistent:!0,"retain-focus":!0,onSave:L,onClose:y},{default:i(()=>[E("p",F,d(e(u).messageCreateExternalAccount1),1),E("p",G,d(e(u).messageCreateExternalAccount2),1)]),_:1},8,["modelValue"])]),_:1}))}});export{ne as default};
