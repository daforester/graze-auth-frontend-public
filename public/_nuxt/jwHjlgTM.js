import{e as W,r as b,f as de,R as be,A as we,g as $,c as j,j as B,o as p,U as Z,h as i,ac as me,w as s,b as u,d as O,t as N,F as ne,a as C,_ as X,P as pe,M as ye,a2 as he,a1 as ke,E as H,ae as Re,Z as Ae,$ as J,k as ae,a7 as Te,V as Ce,a0 as le,af as Ee,ag as Le,ah as xe,a9 as Ie,ai as oe,n as Q,p as Ve,a3 as $e,a4 as De,ab as re}from"./CQQOHgVg.js";import{s as A}from"./B-pYYkJ6.js";import{u as K}from"./BUX9gV8r.js";import{d as fe,e as ue,u as Oe,a as Se,f as Be,m as Ne}from"./C8wZl5yh.js";import{V as F,a as P}from"./hs6exKNd.js";import{V as z,x as qe,y as Pe}from"./Be4K88FQ.js";import{l as Ue,_ as ie}from"./DLuPry4q.js";import{b as Me,u as Fe,c as _e}from"./BGC9nr2s.js";import{u as je}from"./DgX9QmaX.js";import{u as ve}from"./XyDiHmpY.js";import{u as se}from"./BhWtroNR.js";import{V as ze,a as Ge}from"./GrYp5ZhT.js";var S=(e=>(e.ADD_CREDENTIAL="ADD_CREDENTIAL",e.COMBINED="COMBINED",e.LOGIN="LOGIN",e.REGISTER="REGISTER",e))(S||{});const Je={key:1,class:"ma-auto text-left"},Ke={key:2,class:"ma-auto text-left"},Ze={key:3,class:"ma-auto text-left"},We={class:"text-red-darken-1 font-weight-bold"},Ye={class:"text-center mt-4"},He=W({__name:"EmailLoginForm",props:{disabled:{type:Boolean,default:!1},requirePassword:{type:Boolean,default:!0},theme:{default:""},variant:{default:()=>S.COMBINED}},emits:["callback"],async setup(e,{emit:w}){let c,v;const r=b(!0),g=([c,v]=de(()=>K()),c=await c,v(),c),d=w,{smAndUp:l}=be(),f=b(!1),t=b(!1),U=b(!1),y=b(""),V=b(""),k=b(!1),L=b({passwordRequired:T=>!e.requirePassword||!!T||"Required.",required:T=>!!T||"Required.",min:T=>!e.requirePassword||T.length>=8||"Min 8 characters",email:T=>!!T.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)||"Valid email address required"}),x=b(""),a=()=>(x.value="",!(L.value.required(y.value)!==!0||L.value.email(y.value)!==!0||L.value.passwordRequired(V.value)!==!0||L.value.min(V.value)!==!0)),n=(T=>{switch(T.preventDefault(),T.submitter.value){case"add":D();break;case"create":M();break;case"forgot":_();break;case"login":default:R();break}}),R=(()=>{if(!a()){console.log("invalid");return}d("callback",{mode:"login",username:y.value,password:V.value})}),D=((T=void 0)=>{T&&T.preventDefault(),a()&&d("callback",{mode:"add",username:y.value,password:V.value})}),M=((T=void 0)=>{T&&T.preventDefault(),a()&&d("callback",{mode:"create",username:y.value,password:V.value})}),_=(()=>{(x.value="",!(L.value.required(y.value)!==!0||L.value.email(y.value)!==!0))&&d("callback",{mode:"link",username:y.value,password:V.value})});return(T,m)=>{const ee=we("router-link");return r.value?(p(),$(fe,{key:0,onSubmit:me(n,["stop"]),disabled:e.disabled,id:"login-form",action:`${i(g).issuerUri}connect/auth/internal`,method:"post",class:Z(`pa-4 rounded rounded-l ${e.theme?`theme-${e.theme}`:""}`)},{default:s(()=>[u(F,null,{default:s(()=>[u(P,null,{default:s(()=>[u(ue,{margin:"normal",required:"",id:"username",label:"Email Address",name:"username",autocomplete:"username",autofocus:"",variant:"outlined",modelValue:y.value,"onUpdate:modelValue":m[0]||(m[0]=G=>y.value=G),rules:[L.value.required,L.value.email],clearable:!0},null,8,["modelValue","rules"])]),_:1})]),_:1}),e.requirePassword?(p(),$(F,{key:0},{default:s(()=>[u(P,null,{default:s(()=>[u(ue,{margin:"normal",required:"",name:"password",label:"Password",type:k.value?"text":"password",id:"password",autocomplete:"current-password",variant:"outlined",modelValue:V.value,"onUpdate:modelValue":m[1]||(m[1]=G=>V.value=G),"append-inner-icon":k.value?"mdi:mdi-eye-off":"mdi:mdi-eye","onClick:appendInner":m[2]||(m[2]=G=>k.value=!k.value),counter:"",hint:"At least 8 characters",rules:[L.value.required,L.value.min],clearable:!1},null,8,["type","modelValue","append-inner-icon","rules"])]),_:1})]),_:1})):B("",!0),x.value?(p(),$(F,{key:1},{default:s(()=>[u(P,{class:"text-red-darken-1 font-weight-bold"},{default:s(()=>[O(N(x.value),1)]),_:1})]),_:1})):B("",!0),u(F,{justify:"space-between"},{default:s(()=>[e.variant===i(S).COMBINED||e.variant===i(S).REGISTER?(p(),$(P,{key:0,cols:"12",sm:"7",order:"2","order-sm":"1",class:Z(`${i(l)?"":"text-center"}`)},{default:s(()=>[u(z,{color:"orange-darken-2",disabled:e.disabled,type:e.variant===i(S).COMBINED?"button":"submit",class:"w-100","prepend-icon":"mdi:mdi-account-edit",onClick:M,value:"create"},{default:s(()=>[...m[3]||(m[3]=[O(" Create Account ",-1)])]),_:1},8,["disabled","type"])]),_:1},8,["class"])):B("",!0),e.variant===i(S).COMBINED||e.variant===i(S).LOGIN?(p(),$(P,{key:1,cols:"12",sm:"5",order:"1","order-sm":"2",class:Z(`${i(l)?"text-right":"text-center"}`)},{default:s(()=>[u(z,{color:"success",disabled:e.disabled,type:"submit",class:"w-100","prepend-icon":"mdi:mdi-login",value:"login"},{default:s(()=>[...m[4]||(m[4]=[O(" Sign In ",-1)])]),_:1},8,["disabled"])]),_:1},8,["class"])):B("",!0),e.variant===i(S).ADD_CREDENTIAL?(p(),$(P,{key:2,cols:"12",class:"flex-grow-0 text-right"},{default:s(()=>[u(z,{color:"success",disabled:e.disabled,type:"submit",value:"add"},{default:s(()=>[...m[5]||(m[5]=[O(" Add Email ",-1)])]),_:1},8,["disabled"])]),_:1})):B("",!0)]),_:1}),e.variant===i(S).COMBINED||e.variant===i(S).LOGIN?(p(),$(F,{key:2},{default:s(()=>[u(P,null,{default:s(()=>[u(z,{type:"submit",class:"w-100",color:"grey",disabled:e.disabled,"prepend-icon":"mdi:mdi-account-question",value:"forgot"},{default:s(()=>[O(N(i(A).buttonForgottenPassword),1)]),_:1},8,["disabled"])]),_:1})]),_:1})):B("",!0)]),_:1},8,["disabled","action","class"])):f.value?(p(),j("p",Je,N(i(A).messageResetEmail),1)):t.value?(p(),j("p",Ke,N(i(A).messageVerifyNewAccountEmail),1)):U.value?(p(),j("p",Ze,[O(N(i(A).messageVerifiedNewAccountMessage)+" ",1),x.value?(p(),j(ne,{key:0},[m[9]||(m[9]=C("br",null,null,-1)),m[10]||(m[10]=C("br",null,null,-1)),C("span",We,[m[6]||(m[6]=O(" An error occurred creating or recovering account:",-1)),m[7]||(m[7]=C("br",null,null,-1)),O(" "+N(x.value),1)]),m[11]||(m[11]=C("br",null,null,-1)),m[12]||(m[12]=C("br",null,null,-1)),m[13]||(m[13]=C("span",{class:"text-red-darken-4"}," Please contact registration if you require further assistance. ",-1)),C("div",Ye,[u(ee,{to:"/"},{default:s(()=>[u(z,{color:"red"},{default:s(()=>[...m[8]||(m[8]=[O("Close",-1)])]),_:1})]),_:1})])],64)):B("",!0)])):B("",!0)}}}),Qe=X(He,[["__scopeId","data-v-24bbe9ca"]]),Xe=ye({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},..._e(),...Be(),...Ee(Ne({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),ea=pe()({name:"VOtpInput",props:Xe(),emits:{finish:e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,w){let{attrs:c,emit:v,slots:r}=w;const{dimensionStyles:g}=Me(e),{isFocused:d,focus:l,blur:f}=Oe(e),t=he(e,"modelValue","",o=>o==null?[]:String(o).split(""),o=>o.join("")),{t:U}=ke(),y=H(()=>Number(e.length)),V=H(()=>Array(y.value).fill(0)),k=b(-1),L=b(),x=b([]),a=H(()=>x.value[k.value]);let n=!1;Re(()=>e.autofocus,()=>{const o=Le();o.run(()=>{const{intersectionRef:h,isIntersecting:I}=qe();xe(()=>{h.value=x.value[0]}),ae(I,q=>{var E;q&&((E=h.value)==null||E.focus(),o.stop())})})});function R(){if(G(a.value.value)){a.value.value="";return}if(n)return;const o=t.value.slice(),h=a.value.value;o[k.value]=h;let I=null;k.value>t.value.length?I=t.value.length+1:k.value+1!==y.value&&(I="next"),t.value=o,I&&oe(L.value,I)}function D(){n=!1,R()}function M(o){const h=t.value.slice(),I=k.value;let q=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(o.key)&&(o.preventDefault(),o.key==="ArrowLeft"?q="prev":o.key==="ArrowRight"?q="next":["Backspace","Delete"].includes(o.key)&&(h[k.value]="",t.value=h,k.value>0&&o.key==="Backspace"?q="prev":requestAnimationFrame(()=>{var E;(E=x.value[I])==null||E.select()})),requestAnimationFrame(()=>{q!=null&&oe(L.value,q)}))}function _(o,h){var E;h.preventDefault(),h.stopPropagation();const I=((E=h==null?void 0:h.clipboardData)==null?void 0:E.getData("Text").trim().slice(0,y.value))??"",q=I.length-1===-1?o:I.length-1;G(I)||(t.value=I.split(""),k.value=q)}function T(){t.value=[]}function m(o,h){l(),k.value=h}function ee(){f(),k.value=-1}function G(o){return e.type==="number"&&/[^0-9]/g.test(o)}return Ae({VField:{color:J(()=>e.color),bgColor:J(()=>e.color),baseColor:J(()=>e.baseColor),disabled:J(()=>e.disabled),error:J(()=>e.error),variant:J(()=>e.variant),rounded:J(()=>e.rounded)}},{scoped:!0}),ae(t,o=>{o.length===y.value&&v("finish",o.join(""))},{deep:!0}),ae(k,o=>{o<0||Ie(()=>{var h;(h=x.value[o])==null||h.select()})}),Fe(()=>{var I;const[o,h]=Te(c);return C("div",le({class:["v-otp-input",{"v-otp-input--divided":!!e.divider},e.class],style:[e.style]},o),[C("div",{ref:L,class:"v-otp-input__content",style:Ce([g.value])},[V.value.map((q,E)=>C(ne,null,[e.divider&&E!==0&&C("span",{class:"v-otp-input__divider"},[e.divider]),u(Se,{focused:d.value&&e.focusAll||k.value===E,key:E},{...r,loader:void 0,default:()=>C("input",{ref:Y=>x.value[E]=Y,"aria-label":U(e.label,E+1),autofocus:E===0&&e.autofocus,autocomplete:"one-time-code",class:Z(["v-otp-input__field"]),disabled:e.disabled,inputmode:e.type==="number"?"numeric":"text",min:e.type==="number"?0:void 0,maxlength:E===0?y.value:"1",placeholder:e.placeholder,type:e.type==="number"?"text":e.type,value:t.value[E],onInput:R,onFocus:Y=>m(Y,E),onBlur:ee,onKeydown:M,onCompositionstart:()=>n=!0,onCompositionend:D,onPaste:Y=>_(E,Y)},null)})])),C("input",le({class:"v-otp-input-input",type:"hidden"},h,{value:t.value.join("")}),null),u(Ue,{contained:!0,contentClass:"v-otp-input__loader",modelValue:!!e.loading,persistent:!0},{default:()=>{var q;return[((q=r.loader)==null?void 0:q.call(r))??u(Pe,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(I=r.default)==null?void 0:I.call(r)])])}),{blur:()=>{var o;(o=x.value)==null||o.some(h=>h.blur())},focus:()=>{var o;(o=x.value)==null||o[0].focus()},reset:T,isFocused:d}}}),aa=W({__name:"OTPLoginForm",props:{email:{},disabled:{type:Boolean,default:!1},theme:{}},emits:["callback"],setup(e,{emit:w}){const c=w,v=b(""),r=b({required:l=>!!l||"Required.",min:l=>l.length>=6||"Min 6 characters"}),g=b(""),d=(l=>{l.preventDefault(),(g.value="",!(r.value.required(v.value)!==!0||r.value.min(v.value)!==!0))&&c("callback",{mode:"validate",username:e.email,password:v.value})});return(l,f)=>(p(),$(fe,{onSubmit:me(d,["stop"]),disabled:e.disabled,class:Z(`${e.theme?`theme-${e.theme}`:""}`)},{default:s(()=>[f[2]||(f[2]=C("h3",{class:"text-h6 mb-2"}," Please enter the one time password to verify your account ",-1)),C("p",null,"A code has been sent to "+N(e.email),1),u(F,null,{default:s(()=>[u(P,null,{default:s(()=>[u(ea,{disabled:e.disabled,length:"6",modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=t=>v.value=t),rules:[r.value.required,r.value.min]},null,8,["disabled","modelValue","rules"])]),_:1})]),_:1}),u(F,null,{default:s(()=>[u(P,null,{default:s(()=>[u(z,{disabled:v.value.length!=6,type:"submit",color:"primary",variant:"flat",class:"w-100"},{default:s(()=>[...f[1]||(f[1]=[O(" Validate ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["disabled","class"]))}}),ta=X(aa,[["__scopeId","data-v-d02f5948"]]),na=async(e,w,c=!1)=>{const v=await K(),{getAccessToken:r,storeAccessToken:g,storeRefreshToken:d}=se();let l="";try{l=await r()}catch{}return await $fetch(`${v.issuerUri}connect/auth/internal`,{method:"post",body:JSON.stringify({oauth:e,access_token:l,internal:{username:w.username,password:w.password},new:c}),parseResponse:f=>{const t=JSON.parse(f);return t.AccessToken&&g(t.AccessToken),t.RefreshToken&&d(t.RefreshToken),{ErrorMessage:t.ErrorMessage||"",RedirectURI:t.RedirectURI||"",Existing:t.Existing||!1}}})},te=async(e,w,c="",v=!1)=>{const r=await K();return await $fetch(`${r.issuerUri}connect/email/link`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:w,password:c},new:v})})},sa=async(e,w,c=!1)=>{const v=await K(),{storeAccessToken:r,storeRefreshToken:g}=se();return await $fetch(`${v.issuerUri}connect/auth/otp`,{method:"post",body:JSON.stringify({oauth:e,internal:{username:w.username,password:w.password},new:c}),parseResponse:d=>{const l=JSON.parse(d);return l.AccessToken&&r(l.AccessToken),l.RefreshToken&&g(l.RefreshToken),{RedirectURI:l.RedirectURI||"",ErrorMessage:l.ErrorMessage||"",Existing:l.Existing||""}}})},la={class:"ma-auto",style:{"max-width":"450px"}},La=W({__name:"email",props:{mode:{default:"view"},requirePassword:{type:Boolean,default:!0},theme:{default:"shaded"},variant:{default:()=>S.COMBINED}},emits:["cancel","added"],setup(e,{emit:w}){const c=w,v=je(),r=b(""),g=b("email"),d=b(!1),l=ve(),f=b(!1),t=b(),U=a=>{switch(a.mode.toLocaleString()){case"add":return y(a);case"create":return V(a);case"link":return k(a.username);case"login":return x(a);case"register":return;case"validate":return L(a)}},y=async a=>{f.value=!1;const{token:n}=await te(l,a.username,a.password,!0);r.value=a.username,t.value=n,g.value="otp_validate"},V=async a=>{f.value=!1;const{token:n}=await te(l,a.username,a.password,!0);r.value=a.username,t.value=n,g.value="otp_create"},k=async a=>{f.value=!1;const{token:n}=await te(l,a);r.value=a,t.value=n,g.value="otp_validate"},L=async a=>{d.value=!0;const{ErrorMessage:n,Existing:R,RedirectURI:D}=await sa(l,{username:a.username,password:`${t.value}:${a.password}`},g.value=="otp_create");if(e.variant!==S.ADD_CREDENTIAL&&D)try{const _=new URL(D).searchParams.get("error");if((_==null?void 0:_.toLowerCase())!="invalid_request"&&(_==null?void 0:_.toLowerCase())!="access_denied"){Q(D,{external:!0});return}}catch{}else if(e.variant===S.ADD_CREDENTIAL&&R&&!n){f.value=!1,d.value=!1,g.value="",c("added");return}f.value=!0,d.value=!1,g.value="email"},x=async a=>{d.value=!0,f.value=!1;const{RedirectURI:n}=await na(l,a);if(n){const D=new URL(n).searchParams.get("error");if((D==null?void 0:D.toLowerCase())=="invalid_request"){f.value=!0,d.value=!1;return}Q(n,{external:!0})}};return(a,n)=>(p(),j("div",la,[i(f)?(p(),$(F,{key:0},{default:s(()=>[u(P,null,{default:s(()=>[u(ze,{type:"error"},{default:s(()=>[u(Ge,null,{default:s(()=>[...n[1]||(n[1]=[O("Login Failed",-1)])]),_:1}),n[2]||(n[2]=O(" There was problem with your login attempt. It may be the account doesn't exist or your password was incorrect. You may have also created your account using a Telegram login instead. ",-1))]),_:1})]),_:1})]),_:1})):B("",!0),u(F,null,{default:s(()=>[u(P,null,{default:s(()=>[i(g)=="email"?(p(),$(Qe,{key:0,disabled:i(d),"redirect-url":i(v).href,variant:e.variant,theme:e.theme,requirePassword:e.requirePassword,onCallback:U},null,8,["disabled","redirect-url","variant","theme","requirePassword"])):i(g)=="otp_create"||i(g)=="otp_validate"?(p(),$(ta,{key:1,disabled:i(d),email:i(r),theme:e.theme,onCallback:U},null,8,["disabled","email","theme"])):B("",!0)]),_:1})]),_:1}),e.mode=="view"?(p(),$(F,{key:1},{default:s(()=>[u(P,{class:"text-left"},{default:s(()=>[u(z,{color:"error",onClick:n[0]||(n[0]=R=>c("cancel")),class:"w-100","prepend-icon":"mdi:mdi-arrow-left-circle"},{default:s(()=>[...n[3]||(n[3]=[O(" Go Back ",-1)])]),_:1})]),_:1})]),_:1})):B("",!0)]))}}),oa={key:0,class:"ml-1"},ra=W({__name:"AuthButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1},source:{default:"internal"}},setup(e){const w={amazon:{icon:"fa:fas fa-brands fa-amazon",label:A.buttonLoginAmazon,name:"Amazon"},email:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},facebook:{icon:"fa:fa fa-brands fa-facebook",label:A.buttonLoginFaceBook,name:"FaceBook"},google:{icon:"fa:fa fa-brands fa-google",label:A.buttonLoginGoogle,name:"Google"},internal:{icon:"mdi:mdi-email",label:A.buttonLoginEmail,name:"Email"},instagram:{icon:"fa:fa fa-brands fa-instagram",label:A.buttonLoginInstagram,name:"Instagram"},keycloak:{icon:"mdi:mdi-key-variant",label:A.buttonLoginKeycloak,name:"Keycloak"},microsoft:{icon:"fa:fa fa-brands fa-windows",label:A.buttonLoginMicrosoft,name:"Microsoft"},steam:{icon:"fa:fa fa-brands fa-steam",label:A.buttonLoginSteam,name:"Steam"},telegram:{icon:"fa:fa fa-brands fa-telegram",label:A.buttonLoginTelegram,name:"Telegram"},twitch:{icon:"fa:fa fa-brands fa-twitch",label:A.buttonLoginTwitch,name:"Twitch"},twitter:{icon:"fa:fa fa-brands fa-twitter",label:A.buttonLoginTwitter,name:"Twitter"}},c=b(w[e.source.toLowerCase()].label||""),v=b(w[e.source.toLowerCase()].icon||""),r=H(()=>{var g,d;if(e.source.toLowerCase()==="internal"||e.source.toLowerCase()==="email")return(g=e.credential)==null?void 0:g.Email;try{const l=JSON.parse(((d=e.credential)==null?void 0:d.Data)||"{}");switch(e.source.toLowerCase()){case"telegram":return`@${l.username||l.id}`;case"keycloak":return`${l.preferred_username}`}}catch{}return""});return(g,d)=>(p(),$(z,{"append-icon":e.appendIcon,"prepend-icon":v.value,class:Z(`${e.source.toLowerCase()} ${e.class}`)},{default:s(()=>[O(N(c.value)+" ",1),e.showUsername&&e.credential?(p(),j("small",oa,"("+N(r.value)+")",1)):B("",!0)]),_:1},8,["append-icon","prepend-icon","class"]))}}),ge=X(ra,[["__scopeId","data-v-1c6ce024"]]),ce=async(e,w,c=!1)=>{const v=await K(),{getAccessToken:r,storeAccessToken:g,storeRefreshToken:d}=se();let l="";try{l=await r()}catch{}return await $fetch(`${v.issuerUri}connect/auth/telegram`,{method:"post",body:JSON.stringify({oauth:e,access_token:l,telegram:w,new:c}),parseResponse:f=>{const t=JSON.parse(f);return t.AccessToken&&g(t.AccessToken),t.RefreshToken&&d(t.RefreshToken),{RedirectURI:t.RedirectURI||"",ErrorMessage:t.ErrorMessage||"",Existing:t.Existing||!1}}})},ua={key:0,class:"my-2"},ia={key:1,class:"my-2"},ca={class:"my-2"},da={class:"my-2"},ma={class:"my-2"},fa=W({__name:"TelegramButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},class:{default:""},credential:{},showUsername:{type:Boolean,default:!1}},emits:["cancel","added"],async setup(e,{emit:w}){let c,v;const r=w,g=([c,v]=de(()=>K()),c=await c,v(),c);let d=b("");g.telegramBotId&&(d.value=g.telegramBotId);const l=ve(),f=b(!1),t=b(!1),U=b(0),y=b(),V=b(),k=async()=>{if(f.value=!1,!y.value)return;const{ErrorMessage:a,Existing:n,RedirectURI:R}=await ce(l,y.value,!0);n?a?(t.value=!0,U.value=1):r("added"):R&&Q(R,{external:!0})},L=()=>{{const a=window;if(!a.Telegram||!a.Telegram.Login||!a.Telegram.Login.auth){console.error("Telegram not initialised");return}a.Telegram.Login.auth({bot_id:d.value,request_access:!0},n=>{n||console.error("Telegram Authorization Failed"),x(n)})}},x=async a=>{const{Existing:n,RedirectURI:R}=await ce(l,a,!1);if(R)try{const M=new URL(R).searchParams.get("error");M?M=="access_denied"?(f.value=!0,y.value=a):M=="invalid_request"?(t.value=!0,U.value=1):M=="server_error"&&(t.value=!0,U.value=2):Q(R,{external:!0})}catch(D){console.error(D),n&&r("added")}};return Ve(()=>{const a=document.createElement("script");a.async=!0,a.src="https://telegram.org/js/telegram-widget.js?22",V.value.appendChild(a)}),(a,n)=>(p(),j(ne,null,[$e(u(F,null,{default:s(()=>[u(P,{class:"text-center"},{default:s(()=>[C("div",{ref_key:"telegram",ref:V},null,512),u(ge,{"append-icon":e.appendIcon,credential:e.credential,"show-username":e.showUsername,source:"telegram",class:"d-flex justify-start w-100",onClick:L},null,8,["append-icon","credential","show-username"])]),_:1})]),_:1},512),[[De,i(d)]]),u(ie,{modelValue:i(t),"onUpdate:modelValue":n[0]||(n[0]=R=>re(t)?t.value=R:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Telegram Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:n[1]||(n[1]=R=>t.value=!1)},{default:s(()=>[i(U)===1?(p(),j("p",ua,N(i(A).messageCreateTelegramError1),1)):B("",!0),i(U)===2?(p(),j("p",ia,N(i(A).messageCreateTelegramError2),1)):B("",!0)]),_:1},8,["modelValue"]),u(ie,{modelValue:i(f),"onUpdate:modelValue":n[2]||(n[2]=R=>re(f)?f.value=R:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",onSave:k,onClose:n[3]||(n[3]=R=>r("cancel"))},{default:s(()=>[C("p",ca,N(i(A).messageCreateTelegramAccount1),1),C("p",da,N(i(A).messageCreateTelegramAccount2),1),C("p",ma,N(i(A).messageCreateTelegramAccount3),1)]),_:1},8,["modelValue"])],64))}}),va=W({__name:"LoginButton",props:{appendIcon:{type:[String,Array,Function,Object],default:""},credential:{},params:{default:()=>({variant:S.COMBINED})},showUsername:{type:Boolean,default:!1},source:{default:"internal"},url:{default:""}},setup(e){return(w,c)=>e.source=="telegram"?(p(),$(fa,{key:0})):(p(),$(ge,{key:1,"append-icon":e.appendIcon,credential:e.credential,"show-username":e.showUsername,source:e.source,class:"d-flex justify-start w-100"},null,8,["append-icon","credential","show-username","source"]))}}),xa=X(va,[["__scopeId","data-v-f907d1cc"]]),Ia=async e=>{const w=await K();try{const c=await $fetch(`${w.issuerUri}connect/auth/urls?baseRedirect=${e}`,{method:"get",parseResponse:r=>r}),v=JSON.parse(c);return new Map(Object.entries(v.URLs))}catch(c){throw c}};export{ge as A,S as E,xa as L,La as _,Ia as u};
