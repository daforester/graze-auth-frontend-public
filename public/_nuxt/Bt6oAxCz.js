import{u as b,s as c}from"./B-pYYkJ6.js";import{e as q,i as A,l as B,r as p,g as E,w as i,n as _,o as u,j as g,b as v,h as e,ab as R,c as w,t as m,a as k}from"./CQQOHgVg.js";import{u as N,a as $}from"./CB8sPBv5.js";import{_ as L}from"./DLuPry4q.js";import{V as I}from"./R19YWhS6.js";import{V as T,a as j}from"./hs6exKNd.js";import{y as z}from"./Be4K88FQ.js";import"./DdjJ-Vhj.js";import"./BhWtroNR.js";import"./B5CZD0j7.js";import"./BUX9gV8r.js";import"./_7wUQANC.js";import"./BGC9nr2s.js";import"./D1dM1BjZ.js";const D={key:0,class:"my-2"},M={key:1,class:"my-2"},F={key:2,class:"my-2"},G={class:"my-2"},H={class:"my-2"},ce=q({__name:"[method]",setup(J){const S=A(),d=B(),r=p(0),t=p(!1),l=p(!1),{getState:U}=b(),o=U(d.query.state.toString(),!0),C=p(""),x=()=>{_(o.RedirectUri,{external:!0})},P=async()=>{const n=await $(o,C.value);if(n){const a=new URL(n).searchParams.get("error");a?a=="access_denied"&&(t.value=!0,r.value=3):_(n,{external:!0})}else t.value=!0,r.value=2};return o?(async()=>{if(!d.query.code){t.value=!0,r.value=2;return}const n=d.query.code.toString(),s=`${window.location.origin}${S.resolve("/connect/external").href}/keycloak`,{CreateToken:a,RedirectURI:y}=await N(o,n,s,d.params.method.toString(),!1);if(a&&(C.value=a),y){const V=new URL(y),f=V.searchParams.get("error");if(f)f=="access_denied"?l.value=!0:f=="invalid_request"?(t.value=!0,r.value=1):f=="server_error"&&(t.value=!0,r.value=2);else{const h=new URL(o.RedirectUri);h.searchParams.set("state",o.State),h.searchParams.set("code",V.searchParams.get("code")||""),_(h.toString(),{external:!0})}}else t.value=!0,r.value=2})():(t.value=!0,r.value=2),(n,s)=>(u(),E(I,{class:"h-100"},{default:i(()=>[!e(l)&&!e(t)?(u(),E(T,{key:0,class:"h-100"},{default:i(()=>[v(j,{class:"text-center align-content-center"},{default:i(()=>[v(z,{color:"primary",size:110,width:12,indeterminate:""})]),_:1})]),_:1})):g("",!0),v(L,{modelValue:e(t),"onUpdate:modelValue":s[0]||(s[0]=a=>R(t)?t.value=a:null),"show-save-action":!1,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Error Attempting Login","hide-extension":!0,"remove-button-spacer":!0,"close-action-label":"Close",onClose:x},{default:i(()=>[e(r)===1?(u(),w("p",D,m(e(c).messageCreateExternalError1),1)):g("",!0),e(r)===2?(u(),w("p",M,m(e(c).messageCreateExternalError2),1)):g("",!0),e(r)===3?(u(),w("p",F,m(e(c).messageCreateExternalError3),1)):g("",!0)]),_:1},8,["modelValue"]),v(L,{modelValue:e(l),"onUpdate:modelValue":s[1]||(s[1]=a=>R(l)?l.value=a:null),"show-save-action":!0,"show-reset-action":!1,"show-close-action":!0,"show-delete-action":!1,title:"Create new account","hide-extension":!0,"save-button-label":"Create Account",persistent:!0,"retain-focus":!0,onSave:P,onClose:x},{default:i(()=>[k("p",G,m(e(c).messageCreateExternalAccount1),1),k("p",H,m(e(c).messageCreateExternalAccount2),1)]),_:1},8,["modelValue"])]),_:1}))}});export{ce as default};
